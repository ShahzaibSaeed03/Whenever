<!-- Loader (always at root level, not inside ngFor) -->
<!-- <div *ngIf="loading" class="fixed inset-0 bg-black/40 flex justify-center items-center z-50">
  <div class="loader-wrapper">
    <img class="loader-spinner" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/82/loader-spinner.png" />
  </div>
</div> -->


<!-- Works Container -->
<div class="max-w-6xl mx-auto" *ngIf="!loading">
  
  <!-- If user not logged in -->
  <div *ngIf="!isLoggedIn" class="text-center py-10">
    <p class="text-lg font-semibold text-red-600">
      âš  Please login first to see your work.
    </p>
    <button routerLink="/login"
      class="mt-4 px-6 py-2 bg-[#507897] text-white rounded-lg shadow hover:bg-[#366990]">
      Go to Login
    </button>
  </div>

  <!-- Grid of Works -->
  <div *ngIf="isLoggedIn" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    <ng-container *ngFor="let item of data">
      <div class="bg-white rounded-xl shadow-md overflow-hidden card-hover-effect">
        <div class="p-6">

          <!-- Title and Status -->
          <div class="flex justify-between items-start mb-4">
            <h2 class="text-xl font-semibold text-gray-800">{{ item?.title }}</h2>
            <span class="status-badge status-active">{{ item?.status }}</span>
          </div>

          <!-- Work Details -->
          <div class="mb-4 space-y-1">
            <div class="flex items-center space-x-2">
              <span class="text-sm text-gray-500">Document ID: {{ item?.displayed_ID }}</span>
            </div>
            <div class="flex items-center space-x-2">
              <span class="text-sm text-gray-500">Registered: {{ item?.registration_date | date }}</span>
            </div>
            <div class="flex items-center space-x-2">
              <span class="text-sm text-gray-500">File: {{ item?.file_name }}</span>
            </div>
          </div>

          <!-- Detailed Info -->
          <div class="expandable-content mt-4 border-t border-gray-100 pt-4">
            <div class="space-y-3">
              <div>
                <h3 class="text-sm font-medium text-gray-500">Copyright Owner</h3>
                <p class="mt-1 text-sm text-gray-900">{{ item?.copyright_owner }}</p>
              </div>
           
              <button *ngIf="item?._id" (click)="shareWork(item?._id)"
                class="w-full mt-4 py-2 px-4 bg-[#507897] text-white text-sm font-medium rounded-md hover:bg-[#2c6794] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-200">
                <i class="fas fa-share-alt mr-2"></i> Share Work
              </button>
            </div>
          </div>

        </div>
      </div>
    </ng-container>
  </div>

</div>
<!-- Password Modal -->
<div *ngIf="showPasswordModal" class="fixed inset-0 bg-black/40 flex justify-center items-center z-50">
  <div class="bg-white rounded-xl shadow-lg p-6 w-96 relative">

    <!-- Close Button -->
    <button (click)="closeModal()" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700">
      <i class="fas fa-times"></i>
    </button>

    <!-- Title -->
    <h2 class="text-lg font-semibold text-gray-800 flex items-center mb-4">
      <i class="fas fa-lock mr-2 text-[#507897]"></i>
      Protect Your Work
    </h2>

    <p class="text-sm text-gray-600 mb-3">
      Enter a password to protect your work. Others must enter this password to view it.
    </p>

    <!-- Password Input -->
    <div class="relative">
      <input [(ngModel)]="sharePassword" type="{{ showPassword ? 'text' : 'password' }}"
        maxlength="6" placeholder="Enter 6-char password"
        class="w-full border rounded-lg px-3 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-[#507897]" />

      <!-- Toggle visibility -->
      <button type="button" (click)="togglePassword()" 
        class="absolute right-3 top-2.5 text-gray-500 hover:text-gray-700">
        <i class="fas" [ngClass]="showPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
      </button>
    </div>

    <!-- Generate Link -->
    <button (click)="generateShareLink()" 
      [disabled]="sharePassword.length !== 6"
      class="w-full mt-5 py-2 px-4 bg-[#507897] text-white text-sm font-medium rounded-md hover:bg-[#2c6794] disabled:opacity-50">
      <i class="fas fa-link mr-2"></i> Generate Link
    </button>
  </div>
</div>
